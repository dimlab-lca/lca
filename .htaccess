# .htaccess for LCA TV - Root Domain Configuration
# Domain: lca-tv.bf points to /lca folder
# All routes work at root level (no /lca prefix needed)

RewriteEngine On

# Force HTTPS in production
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !^localhost
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Route all non-static requests to the Flask application via Passenger
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/static/
RewriteRule ^(.*)$ passenger_wsgi.py/$1 [QSA,L]

# Configuration for static files (CSS, JS, images)
<FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
    Header set Cache-Control "public, immutable"
</FilesMatch>

# Configuration for Python files - use Passenger
<FilesMatch "\.py$">
    SetHandler passenger-python
</FilesMatch>

# Security - Hide sensitive files
<FilesMatch "\.(env|log|db|sqlite|bak|pyc)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Custom error pages
ErrorDocument 404 /404.html
ErrorDocument 500 /500.html

# MIME types
AddType application/javascript .js
AddType text/css .css
AddType image/svg+xml .svg

# Compression for better performance
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>